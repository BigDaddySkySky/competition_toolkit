---
# ============================================
# AUDITD MONITORING ROLE
# ============================================
- name: Display auditd monitoring header
  ansible.builtin.debug:
    msg:
      - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
      - "ğŸ“Š Auditd Monitoring: {{ inventory_hostname }}"
      - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

- name: Include installation tasks
  ansible.builtin.include_tasks: install.yml
  when: auditd_enabled | bool

- name: Include configuration tasks
  ansible.builtin.include_tasks: configure.yml
  when: auditd_enabled | bool

- name: Include Discord alert configuration
  ansible.builtin.include_tasks: discord_alerts.yml
  when:
    - auditd_enabled | bool
    - auditd_enable_discord_alerts | bool
    - vault_discord_webhook_url is defined
    - vault_discord_webhook_url != ""

- name: Display completion message
  ansible.builtin.debug:
    msg:
      - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
      - "âœ… Auditd Monitoring Complete: {{ inventory_hostname }}"
      - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
